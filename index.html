<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Codoo</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{height:100vh;font-family:system-ui,sans-serif;background:#0b0b0b;color:#eaeaea;overflow:hidden;display:flex;flex-direction:column;}
.topbar{height:48px;display:flex;align-items:center;padding:0 14px;border-bottom:1px solid #222;}
.logo{font-family:Consolas,monospace;font-weight:bold;font-size:16px;}
.actions{margin-left:auto;display:flex;gap:8px;}
.btn{background:#141414;color:#eaeaea;border:1px solid #2a2a2a;padding:6px 12px;cursor:pointer;border-radius:4px;}
.btn:hover{background:#1d1d1d;}
.symbol-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:14px;padding:0;border-radius:4px;}
#editor{flex:1;}
#runOverlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:50;opacity:0;transition:opacity 1s ease;}
#runOverlay.show{display:flex;}
#runOverlay.visible{opacity:1;}
.runPanel{width:92%;max-width:900px;height:80%;background:#fff;display:flex;flex-direction:column;border-radius:6px;overflow:hidden;}
.runHeader{background:#111;color:#fff;padding:8px 10px;display:flex;justify-content:space-between;align-items:center;}
iframe{flex:1;border:none;}
#templatesBtn{display:flex;align-items:center;gap:6px;background:#141414;color:#eaeaea;padding:6px 12px;border-radius:8px;border:1px solid #2a2a2a;cursor:pointer;}
#templatesBtn:hover{background:#1d1d1d;}
#templatesPanel{position:fixed;top:52px;left:10px;width:90%;max-width:350px;max-height:70%;background:#141414;color:#eaeaea;border:1px solid #2a2a2a;border-radius:6px;overflow-y:auto;display:none;flex-direction:column;padding:10px;z-index:60;box-shadow:0 0 12px rgba(0,0,0,0.5);}
.template-category{font-weight:bold;margin:6px 0 4px;}
.template-item{background:#1a1a1a;padding:6px 10px;margin:2px 0;border-radius:4px;cursor:pointer;}
.template-item:hover{background:#222;}
@media(max-width:600px){#templatesPanel{top:50px;left:5px;width:95%;max-width:none;max-height:60%;} .runPanel{width:95%;height:75%;}}
</style>

<script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
</head>
<body>

<div class="topbar">
  <div class="logo">Codoo</div>
  <div class="actions">
    <button class="symbol-btn btn" id="undoBtn">&#x2190;</button>
    <button class="symbol-btn btn" id="redoBtn">&#x2192;</button>
    <button class="btn" id="templatesBtn">&#x3C;/&#x3E; Templates</button>
    <button class="btn" onclick="copyCode()">Copy</button>
    <button class="btn" onclick="runCode()">Run</button>
  </div>
</div>

<div id="templatesPanel"></div>
<div id="editor"></div>

<div id="runOverlay">
  <div class="runPanel">
    <div class="runHeader">
      <span>Output</span>
      <button class="btn" onclick="closeRun()">Close</button>
    </div>
    <iframe id="output"></iframe>
  </div>
</div>

<script>
let editor;
require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.45.0/min/vs' }});
require(['vs/editor/editor.main'], () => {
  editor = monaco.editor.create(document.getElementById('editor'), {
    value: `<!DOCTYPE html>
<html>
<body style="background:#111;color:white;font-family:sans-serif">
<h1>Hello World</h1>
<script>console.log("Hello World")<\/script>
</body>
</html>`,
    language:'html',
    theme:'vs-dark',
    automaticLayout:true,
    fontSize:14,
    minimap:{enabled:false},
    wordWrap:'on',
    autoClosingBrackets:'always',
    autoClosingQuotes:'always'
  });
});

function runCode(){
  const overlay=document.getElementById('runOverlay');
  overlay.classList.add('show');
  requestAnimationFrame(()=>overlay.classList.add('visible'));
  document.getElementById('output').srcdoc=editor.getValue();
}
function closeRun(){
  const overlay=document.getElementById('runOverlay');
  overlay.classList.remove('visible');
  setTimeout(()=>overlay.classList.remove('show'),1000);
}
function copyCode(){navigator.clipboard.writeText(editor.getValue());}
document.getElementById('undoBtn').onclick=()=>editor.trigger('keyboard','undo',null);
document.getElementById('redoBtn').onclick=()=>editor.trigger('keyboard','redo',null);

/* ===== TEMPLATES ===== */
const templates={
  "HTML":[
`<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
<p>Paragraph example</p>
</body>
</html>`,
`<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
<ul>
<li>Item 1</li>
<li>Item 2</li>
</ul>
</body>
</html>`
],
  "CSS":[
`<!DOCTYPE html>
<html>
<body>
<h1 style="color:white;background:black;">Hello World</h1>
<style>body{background:#111;color:white}</style>
</body>
</html>`,
`<!DOCTYPE html>
<html>
<body>
<p style="color:gray">Hello World</p>
<style>p{font-size:18px}</style>
</body>
</html>`
],
  "JS":[
`<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
<script>console.log("Hello World")<\/script>
</body>
</html>`,
`<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
<script>alert("Hello World")<\/script>
</body>
</html>`
]
};
const templatesPanel=document.getElementById('templatesPanel');
const templatesBtn=document.getElementById('templatesBtn');
templatesBtn.onclick=()=>{templatesPanel.style.display=templatesPanel.style.display==='flex'?'none':'flex';renderTemplates();};
function renderTemplates(){
  templatesPanel.innerHTML='';
  for(const cat in templates){
    const catEl=document.createElement('div');
    catEl.className='template-category';
    catEl.textContent=cat;
    templatesPanel.appendChild(catEl);
    templates[cat].forEach(t=>{
      const tBtn=document.createElement('div');
      tBtn.className='template-item';
      tBtn.textContent='Template';
      tBtn.onclick=()=>{editor.setValue(t); templatesPanel.style.display='none';};
      templatesPanel.appendChild(tBtn);
    });
  }
}
</script>
</body>
</html>
